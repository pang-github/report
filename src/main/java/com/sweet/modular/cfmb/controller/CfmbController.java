package com.sweet.modular.cfmb.controller;import com.alibaba.fastjson.JSON;import com.sweet.core.translationDict.DictParam;import com.sweet.core.translationDict.TranslationDict;import com.sweet.core.util.RedisUtil;import com.sweet.modular.cfnr.entity.Cfnr;import com.sweet.modular.cfnr.service.CfnrService;import com.sweet.modular.rxdrug.entity.Rxdrug;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.model.ResultBean;import com.sweet.core.model.system.LayuiPageInfo;import com.sweet.modular.cfmb.entity.Cfmb;import com.sweet.modular.cfmb.service.CfmbService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.util.StringUtil;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.stereotype.Controller;import javax.servlet.http.HttpServletRequest;import java.util.List;/** * <p> * 处方模板 前端控制器 * </p> * * @author admin * @since 2020-01-08 */@Controller@RequestMapping("/admin/cfmb")public class CfmbController {    @Autowired    CfmbService cfmbService;    @Autowired    RedisUtil redisUtil;    @Autowired    CfnrService cfnrService;    /**     * 列表页     */    @RequestMapping("/cfmb_list")    public String list(){        return "/modular/cfmb/cfmb_list";    }    /**     * 编辑页     */    @RequestMapping("/cfmb_edit")    public String edit(){        return "/modular/cfmb/cfmb_edit";    }    /**     * 添加/编辑     */    @RequestMapping("/editCfmb")    @ResponseBody    public ResultBean editCfmb(Cfmb cfmb){        cfmbService.saveOrUpdate(cfmb);        return ResultBean.success(cfmb);    }    /**     * 添加     */    @RequestMapping("/addCfmb")    @ResponseBody    public ResultBean addCfmb(Cfmb cfmb,String rxdata){        cfmbService.saveOrUpdate(cfmb);        if(StringUtil.isNotEmpty(rxdata)){            List<Cfnr> cfnrList =  JSON.parseArray(rxdata,Cfnr.class);            cfnrList.stream().forEach(cfnr -> {                cfnr.setRecipeId(cfmb.getId());                cfnrService.saveOrUpdate(cfnr);            });        }        return ResultBean.success(cfmb);    }    /**     * 删除     */    @RequestMapping("/delCfmb")    @ResponseBody    public ResultBean delCfmb(Cfmb cfmb){        cfmbService.removeById(cfmb);        return ResultBean.success(cfmb);    }    /**     * 添加修改菜单     * @param menu     * @return     */    @RequestMapping("/getCfmbDetail")    @ResponseBody    public ResultBean getCfmbDetail(String id){        Cfmb cfmb = cfmbService.getById(id);        return ResultBean.success(cfmb);    }    /**     * 列表数据     */    @RequestMapping("/getCfmbList")    @ResponseBody    @TranslationDict({    })    public LayuiPageInfo getCfmbList(Cfmb Cfmb){        LayuiPageInfo pageInfo = cfmbService.findPageBySpec(Cfmb);        return pageInfo;    }}