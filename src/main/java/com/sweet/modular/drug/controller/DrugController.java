package com.sweet.modular.drug.controller;import com.sweet.core.translationDict.DictParam;import com.sweet.core.translationDict.TranslationDict;import com.sweet.core.util.RedisUtil;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.model.ResultBean;import com.sweet.core.model.system.LayuiPageInfo;import com.sweet.modular.drug.entity.Drug;import com.sweet.modular.drug.service.DrugService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.util.StringUtil;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.stereotype.Controller;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;/** * <p> * 药物表 前端控制器 * </p> * * @author admin * @since 2020-01-08 */@Controller@RequestMapping("/admin/drug")public class DrugController {    @Autowired    DrugService drugService;    @Autowired    RedisUtil redisUtil;    /**     * 列表页     */    @RequestMapping("/drug_list")    public String list(Model model){        String drugPrice =  String.valueOf(redisUtil.get("drugPrice"));        model.addAttribute("drugPrice",drugPrice);        return "/modular/drug/drug_list";    }    /**     * 编辑页     */    @RequestMapping("/drug_edit")    public String edit(Model model){        String drugPrice =  String.valueOf(redisUtil.get("drugPrice"));        model.addAttribute("multiple",drugPrice);        return "/modular/drug/drug_edit";    }    /**     * 添加/编辑     */    @RequestMapping("/editDrug")    @ResponseBody    public ResultBean editDrug(Drug drug){        drugService.saveOrUpdate(drug);        return ResultBean.success(drug);    }    /**     * 删除     */    @RequestMapping("/delDrug")    @ResponseBody    public ResultBean delDrug(Drug drug){        drugService.removeById(drug);        return ResultBean.success(drug);    }    /**     * 添加修改菜单     * @param menu     * @return     */    @RequestMapping("/getDrugDetail")    @ResponseBody    public ResultBean getDrugDetail(String id){        Drug drug = drugService.getById(id);        return ResultBean.success(drug);    }    /**     * 列表数据     */    @RequestMapping("/getDrugList")    @ResponseBody    @TranslationDict({    })    public LayuiPageInfo getDrugList(Drug Drug){        LayuiPageInfo pageInfo = drugService.findPageBySpec(Drug);        return pageInfo;    }    //获取所有数据    @RequestMapping("/getallDrug")    @ResponseBody    public LayuiPageInfo getallDrug(Drug Drug){            LayuiPageInfo  pageInfo = drugService.findPageBySpec(Drug);            return pageInfo;    }    /**     * 按照新的比例调控价格     * @return     */    @ResponseBody    @RequestMapping("/drugPrice")    public ResultBean upuprice (HttpServletRequest request, HttpServletResponse response, Drug Drug,String ids){        String num = request.getParameter("drugPrice");        String substring = ids.substring(0, ids.length() - 1);        String[] split = substring.split(",");        for (String string2 : split) {            redisUtil.set("drugPrice",num);            Float newnum = Float.valueOf(num) / 100;            this.drugService.updateprice(Drug,newnum.toString(),string2);        }        return ResultBean.success();    }}