<% layout("/common/_container.html"){ %><div class="layui-fluid" id="app">    <div class="layui-card" style="max-width: 60%;margin:30px auto;">        <div class="layui-card-body" >            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 35px;">                <legend></legend>            </fieldset>            <form class="layui-form" lay-filter="taskQuartzForm" style="margin: 35px 0 30px 20%;">                    <input type="hidden" name="id">                    <div class="layui-form-item">                        <label class="layui-form-label">任务分组</label>                        <div class="layui-input-inline">                            <input name="jobGroup" type="text" placeholder="请输入任务分组" class="layui-input" lay-verify="" />                        </div>                    </div>                    <div class="layui-form-item">                        <label class="layui-form-label">任务名</label>                        <div class="layui-input-inline">                            <input name="jobName" type="text" placeholder="请输入任务名" class="layui-input" lay-verify="" />                        </div>                    </div>                    <div class="layui-form-item">                        <label class="layui-form-label">任务描述</label>                        <div class="layui-input-inline">                            <input name="description" type="text" placeholder="请输入任务描述" class="layui-input" lay-verify="" />                        </div>                    </div>                    <div class="layui-form-item">                        <label class="layui-form-label">cron表达式</label>                        <div class="layui-input-inline">                            <input id="cronExpression" name="cronExpression"  type="text" placeholder="请输入cron表达式" class="layui-input" lay-verify="" />                        </div>                        <button type="button" @click="openCron" class="layui-btn">cron生成器</button>                    </div>                    <div class="layui-form-item">                        <label class="layui-form-label">包类名</label>                        <div class="layui-input-inline">                            <input name="jobClassName" type="text" placeholder="请输入任务执行时包名类名" class="layui-input" lay-verify="" />                        </div>                    </div>                    <div class="layui-form-item">                        <label class="layui-form-label">选择模板</label>                        <div class="layui-input-inline">                            <input id="tplName" name="tplName" type="text" placeholder="随访模板" class="layui-input" lay-verify="" />                            <input id="tplId" name="tplId" type="hidden">                        </div>                    </div>                <div class="layui-form-item">                    <label class="layui-form-label">随访人群</label>                    <div class="layui-input-inline">                        <select name="patientType" lay-search lay-filter="patientType" lay-verify="">                            <option></option>                            <option v-for="item in patientTypeDic" :value="item.dictId">{{item.name}}</option>                        </select>                    </div>                </div>                    <div class="layui-form-item" style="margin:28px 30px;">                        <div class="layui-input-block">                            <button type="button" class="layui-btn" lay-filter="taskQuartzForm" lay-submit>提交</button>                            <button type="button" class="layui-btn layui-btn-primary" @click="back">返回</button>                        </div>                    </div>            </form>        </div>    </div></div><script>        layui.use(['tableSelect'], function(){            tableSelect = layui.tableSelect;        })        var vm = new Vue({        el: '#app',        data: {            msg: 'Hello World!',            info:{},            corn:'',            patientTypeDic:[],        },        computed:{        },        methods: {            getDetail:async function(id){                vm.info = await request.fetch("getTaskQuartzDetail",{id:id});                form.val('taskQuartzForm', vm.info);            },            back:function(){                location.href = 'taskQuartz_list';            },            getDic:async function(){                 var data = {                     patientType:'9ae86115b7f4d79b2d8dfa5a381c6bdc',                 }                 var res = await api.getDictList(data);                 vm.patientTypeDic = res.patientType;            },            openCron:function () {                top.layui.admin.open({                    type: 2,                    title: 'CRON生成器',                    content: '/admin/taskQuartz/cron',                    area: ['80%', '80%'],                    success:function ( layero,index) {                        var iframeWin = $(layero).find("iframe")[0].contentWindow;                        iframeWin.getcron(function (cron) {                            $('#cronExpression').val(cron);                            top.layer.close(index);                        })                    }                });            }        },        mounted:async function() {            vm = this;            var id = app.getUrlParam('id');            await vm.getDic();            app.isNotEmpty(id) && await vm.getDetail(id);            form.on('submit(taskQuartzForm)', function (data) {                request.post("editTaskQuartz",data.field).then(res=>{                    app.success("操作成功！");                    location.href = 'taskQuartz_list'                })                return false;            });            tableSelect.render({                elem: '#tplName',	//定义输入框input对象                checkedKey: 'tplId', //表格的唯一建值，非常重要，影响到选中状态 必填                searchKey: 'keyword',	//搜索输入框的name值 默认keyword                searchPlaceholder: '关键词搜索',	//搜索输入框的提示文字 默认关键词搜索                table: {	//定义表格参数，与LAYUI的TABLE模块一致，只是无需再定义表格elem                    url:'/admin/template/getTemplateList',                    cols: [[                        {type: 'radio'},                        {field: 'tplId', hide: true, title: 'tplId'},                        {field: 'title',title: '模板名称',width: 120},                        {field: 'createTime',title: '创建时间',}                    ]]                },                done: function (elem, data) {                    //选择完后的回调，包含2个返回值 elem:返回之前input对象；data:表格返回的选中的数据 []                    //拿到data[]后 就按照业务需求做想做的事情啦~比如加个隐藏域放ID...                    var data = data.data[0];                    $('#tplName').val(data.title);                    $('#tplId').val(data.tplId);                }            })            form.render();        },        updated: function () {            form.render();        }    })</script><% } %><style>    .layui-input-inline{        min-width:350px !important;    }</style>