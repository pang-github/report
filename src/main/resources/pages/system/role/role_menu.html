<%layout("/common/_container.html"){%><div class="layui-fluid" id="app">            <div class="layui-row" style="margin-top:15px;background: #fff;padding: 20px;">                    <div id="lay-tree" style="font-size: 15px;margin-top: 20px;"></div>            </div>            <div class="layui-row" style="background: #CFD4D5;padding: 10px;margin-top: 10px;">                <div style="text-align: center;">                    <button class="layui-btn layui-btn-sm" @click="saveButton">保存</button>                    <button class="layui-btn layui-btn-sm layui-btn-primary" type="button" ew-event="closeDialog">取消</button>                </div>            </div></div><script>    var vm = new Vue({        el: '#app',        data: {            msg: 'Hello World!',            tree:''        },        methods: {            saveButton:function () {                //获得选中的节点                var checkedData = tree.getChecked('demoTree');                var idArray = new Array();                if (checkedData.length == 0) {                    layer.msg("请勾选相应权限")                    return ;                } else {                    for (var i = 0; i < checkedData.length; i++) {                        idArray.push(checkedData[i].id);                        if(checkedData[i].children){                            if (checkedData[i].children.length > 0) {                                getTreeIds(checkedData[i].children);                            }                        }                    }                }                function getTreeIds(obj) {                    for (var i = 0; i < obj.length; i++) {                        idArray.push(obj[i].id);                        if (obj[i].children) {                            getTreeIds(obj[i].children);                        }                    }                }                api.setAuthority('${parameter.roleId}',idArray,function (res) {                    admin.putTempData('formOk', true);                    //关掉对话框                    admin.closeThisDialog();                });            }        },        mounted:async function() {            vm = this;            vm.tree = (await api.getMenuTree())[0].children;            //左侧树形            var treeOption = {                elem: '#lay-tree'  //绑定元素                ,id: 'demoTree' //定义索引                ,data: vm.tree                ,showCheckbox: true  //是否显示复选框                ,click: function(obj){                    var elem = obj.elem; //得到当前节点元素                    $(elem).find('.layui-form-checkbox').click();                }                ,operate: function(obj){                    var type = obj.type; //得到操作类型：add、edit、del                    var data = obj.data; //得到当前节点的数据                    var elem = obj.elem; //得到当前节点元素                    //Ajax 操作                    var id = data.id; //得到节点索引                    if(type === 'add'){ //增加节点                        var key;                        request.$postData('/admin/dept/addDept',{deptId:id},function (res) {                            key = res.deptId;                        })                        return key;                    } else if(type === 'update'){ //修改节点                        var text = elem.find('.layui-tree-txt').html();                        data.text = text;                        api.editDept(data.id,data.text);                    }else if(type === 'del'){ //修改节点                        api.delDept(data.id);                    }                }            }            var laytree = tree.render(treeOption);            var data = await api.getAuthority('${parameter.roleId}');            tree.setChecked('demoTree',data); //单个勾选 id 为 1 的节点            form.render();        },        updated: function () {            form.render();        }    })</script><% } %>