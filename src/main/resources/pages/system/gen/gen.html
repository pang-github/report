<%layout("/common/_container.html"){%><div class="layui-fluid" id="app" >    <div class="layui-row layui-col-space15">        <div class="layui-col-xs12">            <div class="layui-card">                <div class="layui-card-body layui-text" style="color: #333;">                    代码生成                </div>            </div>            <div class="layui-card">                <div class="layui-card-body" style="padding: 30px;">                    <div class="layui-form" >                        <div class="layui-form-item">                            <label class="layui-form-label">作者</label>                            <div class="layui-input-block">                                <input type="text" id="author" name="author"   lay-verify="required" autocomplete="off" placeholder="代码生成注释的作者" class="layui-input" value="${shiroUser.userName}">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">模块名称 <i class="layui-icon layui-icon-tips" lay-tips="利用模块名称来为业务分类，本字段可为空"></i></label>                            <div class="layui-input-block">                                <input type="text" id="modularName" name="modularName"     lay-verify="required" autocomplete="off" placeholder="模块名称" class="layui-input">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">上级模块名称 <i class="layui-icon layui-icon-tips" lay-tips="利用模块名称来为业务分类，本字段可为空"></i></label>                            <div class="layui-input-block">                                <input type="text" id="lastModularName" name="lastModularName"  v-model="lastModularName" lay-verify="required" autocomplete="off" placeholder="上级模块名称" class="layui-input">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">表前缀移除 <i class="layui-icon layui-icon-tips" lay-tips="移除表的前缀关键字"></i></label>                            <div class="layui-input-block">                                <input type="text" id="removePrefix" name="removePrefix"   lay-verify="required" v-model="removePrefix" autocomplete="off" placeholder="表前缀移除" class="layui-input">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">选择表</label>                            <div class="layui-input-block">                                <table class="layui-hide" id="dbTableList" lay-filter="dbTableList"></table>                            </div>                        </div>                        <div class="layui-form-item">                            <div class="layui-input-block">                                <button class="layui-btn" @click="execute">生成代码</button>                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div></div><script type="text/html" id="tableBar">    <a class="layui-btn layui-btn-xs layui-hide" name="con-btn" id="{{d.tableName}}_opt" lay-event="conditionEdit" lay-tips="配置生成mapper.xml时，是否生成相关查询条件">查询条件</a></script><script>    var vm = new Vue({        el: '#app',        data: {            msg: 'Hello World!',            info:{},            removePrefix:'business_',            lastModularName:'admin'        },        methods: {            execute:function(){                vm.info.author = $("#author").val();                vm.info.removePrefix = $("#removePrefix").val();                vm.info.modularName = $("#modularName").val();                vm.info.lastModularName = $("#lastModularName").val();                if(app.isEmpty(vm.info.tableName)){                    alert("请选择要生成的表！");                }else if(app.isEmpty(vm.info.modularName)){                    alert("模块名为必填项！");                }else{                    request.post("/admin/gen/execute",{                        author:vm.info.author,                        tableName:vm.info.tableName,                        removePrefix:vm.info.removePrefix,                        modularName: vm.info.modularName,                        lastModularName: vm.info.lastModularName                    }).then(res=>{                        app.success("代码生成成功！")                    })                }            }        },        mounted:async function() {            vm = this;            table.render({                elem: '#dbTableList'                , url: '/admin/gen/tableList'                , page: false                , cols: [[                    {type: 'radio'}                    , {field: 'tableName', title: '表的名称'}                    , {field: 'tableComment', title: '表的名称注释'}                    , {toolbar: '#tableBar', title: '操作'}                ]]            });            table.on('radio(dbTableList)', function (obj) {                //选中行后，显示对应的操作按钮                $("a[name='con-btn']").addClass("layui-hide")                if (obj.checked) {                    $("#" + obj.data.tableName + "_opt").removeClass("layui-hide");                } else {                    $("#" + obj.data.tableName + "_opt").addClass("layui-hide");                }            });            table.on('tool(dbTableList)', function (obj) {                var data = obj.data;                var layEvent = obj.event;                if (layEvent === 'conditionEdit') {                    var removePrefix  = $("#removePrefix").val();                    $("#modularName").val(app.toHump(data.tableName.replace(removePrefix,"")));                    top.layui.admin.open({                        type: 2,                        title: '选择字段',                        area: ['90%', '80%'],                        maxmin: true,                        content: '/admin/gen/tableFields?tableName='+data.tableName,                        success:function () {                            vm.info.tableName = data.tableName;                        }                    });                }                return false;            });            form.render();        },        updated: function () {            form.render();        }    })</script><% } %>